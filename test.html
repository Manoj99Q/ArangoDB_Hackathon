<html lang="en">
  <head>
  <meta charset="UTF-8">
  <script src="https://d3js.org/d3.v6.min.js"></script>
  <style>
      body { 
          font: 14px sans-serif; 
          margin: 0; 
          padding: 0;
          width: 100vw;
          height: 100vh;
          background-color: white;
          overflow: hidden;
      }
      
      #visualization-container {
          width: 100vw;
          height: 100vh;
          position: relative;
          overflow: hidden;
      }  
      
      svg {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          display: block;
      }
  </style>
  </head>
  <body>
  <div id="visualization-container">
      <svg></svg>
  </div>
  <script>
      // Data from the application state
      const data = {"total_number_of_games": [3600]};
      
      // Function to get dimensions with margins
       function getDimensions() {
          const container = document.getElementById('visualization-container');
          const fullWidth = container.clientWidth;
          const fullHeight = container.clientHeight;
          
          const margin = {top: 20, right: 20, bottom: 20, left: 20};
          const width = fullWidth - margin.left - margin.right;
          const height = fullHeight - margin.top - margin.bottom;
          
          return { width, height, margin, fullWidth, fullHeight };
      }
      // Get SVG dimensions
      const svg = d3.select("svg")
          .attr("preserveAspectRatio", "xMidYMid meet")
          .attr("viewBox", function() {
              const dims = getDimensions();
              return `0 0 ${dims.fullWidth} ${dims.fullHeight}`;
          });

      let { width:a, height:b, margin:c, fullWidth, fullHeight } = getDimensions();

      // Create main group
      const g = svg.append("g")
          .attr("transform", `translate(${c.left},${c.top})`);

      // Update zoom behavior to use dynamic dimensions
      const zoom = d3.zoom()
          .scaleExtent([0.1, 4])
          .on("zoom", (event) => {
              g.attr("transform", event.transform);
          });

      svg.call(zoom);
  </script>
  

<script>
// Add visualization-specific styles
const styles = `
.bar { fill: #4CAF50; }
.bar:hover { fill: #45a049; }
.axis-label { font-size: 12px; fill: #333; }
.bar-value { font-size: 12px; fill: #333; text-anchor: middle; }
`;

// Add styles to document
const styleSheet = document.createElement("style");
styleSheet.textContent = styles;
document.head.appendChild(styleSheet);

// // Data validation
// if (!data || !data.total_number_of_games || !Array.isArray(data.total_number_of_games)) {
// console.error('Invalid or missing data');
// return;
// }

// Get current dimensions
const dimensions = getDimensions();
const { width, height, margin } = dimensions;

// Clear existing elements
g.selectAll('*').remove();

// Create scales
const xScale = d3.scaleBand()
.domain(['Total Games'])
.range([0, width])
.padding(0.4);

const yScale = d3.scaleLinear()
.domain([0, Math.max(...data.total_number_of_games) * 1.1]) // Add 10% padding
.range([height, 0]);

// Create axes
const xAxis = d3.axisBottom(xScale);
const yAxis = d3.axisLeft(yScale);

// Add X axis
g.append('g')
.attr('class', 'x-axis')
.attr('transform', `translate(0, ${height})`)
.call(xAxis);

// Add Y axis
g.append('g')
.attr('class', 'y-axis')
.call(yAxis);

// Add X axis label
g.append('text')
.attr('class', 'axis-label')
.attr('text-anchor', 'middle')
.attr('x', width / 2)
.attr('y', height + margin.bottom - 10)
.text('Total Games');

// Add Y axis label
g.append('text')
.attr('class', 'axis-label')
.attr('text-anchor', 'middle')
.attr('transform', 'rotate(-90)')
.attr('x', -height / 2)
.attr('y', -margin.left + 20)
.text('Count');

// Create bars
const bars = g.selectAll('.bar')
.data(data.total_number_of_games)
.join('rect')
.attr('class', 'bar')
.attr('x', () => xScale('Total Games'))
.attr('y', height)
.attr('width', xScale.bandwidth())
.attr('height', 0);

// Add transition
bars.transition()
.duration(750)
.attr('y', d => yScale(d))
.attr('height', d => height - yScale(d));

// Add value labels
g.selectAll('.bar-value')
.data(data.total_number_of_games)
.join('text')
.attr('class', 'bar-value')
.attr('x', () => xScale('Total Games') + xScale.bandwidth() / 2)
.attr('y', d => yScale(d) - 5)
.text(d => d)
.style('opacity', 0)
.transition()
.duration(750)
.style('opacity', 1);

// Add tooltip
const tooltip = d3.select('body')
.append('div')
.style('position', 'absolute')
.style('background', 'white')
.style('padding', '5px')
.style('border', '1px solid #ccc')
.style('border-radius', '3px')
.style('opacity', 0);

// Add hover interactions
bars.on('mouseover', function(event, d) {
d3.select(this).transition()
.duration(200)
.attr('fill', '#45a049');

tooltip.transition()
.duration(200)
.style('opacity', .9);

tooltip.html(`Total Games: ${d}`)
.style('left', (event.pageX + 10) + 'px')
.style('top', (event.pageY - 28) + 'px');
})
.on('mouseout', function() {
d3.select(this).transition()
.duration(200)
.attr('fill', '#4CAF50');

tooltip.transition()
.duration(500)
.style('opacity', 0);
});

// Handle window resize
window.addEventListener('resize', () => {
const newDimensions = getDimensions();
// Update scales and redraw visualization
// ... (implement resize handling if needed)
});
</script>

</body>
</html>